<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>K-mita Analytics Dashboard</title>
    <script src="config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="shopify-analytics-styles.css">
    <link rel="icon" type="image/x-icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üêà</text></svg>">
</head>

<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <div class="login-header">
                <h1>üêà K-mita Analytics</h1>
                <p class="text-center text-gray-600 dark:text-gray-400 mb-8">Dashboard Profesional de An√°lisis
                    VERSION:DEMO</p>
            </div>
            <form id="loginForm" class="space-y-6">
                <div class="space-y-2">
                    <label for="username"
                        class="block text-sm font-semibold text-gray-700 dark:text-gray-300">Usuario</label>
                    <input type="text" id="username" class="k-input w-full" placeholder="Ingresa tu usuario" required>
                </div>
                <div class="space-y-2">
                    <label for="password"
                        class="block text-sm font-semibold text-gray-700 dark:text-gray-300">Contrase√±a</label>
                    <input type="password" id="password" class="k-input w-full" placeholder="Ingresa tu contrase√±a"
                        required>
                </div>
                <div id="loginError" class="login-error hidden"></div>
                <button type="submit" class="login-btn">
                    <span class="flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1">
                            </path>
                        </svg>
                        Iniciar Sesi√≥n
                    </span>
                </button>
            </form>
            <div class="mt-6 text-center">
                <p class="text-xs text-gray-500 dark:text-gray-400">
                    ¬© 2025 K-mita Analytics. Todos los derechos reservados.
                </p>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardContainer" class="hidden">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="header-left">
                    <h1 class="dashboard-title">üêà K-mita Analytics</h1>
                    <div id="dataSourceStatus" class="data-source-status">Cargando datos...</div>
                    <div id="autoRefreshStatus" class="auto-refresh-status" style="display: none;">
                        üîÑ Auto-refresh: Configurado para 6 horas
                    </div>
                    <div id="filterStatus" class="filter-status" style="display: none;">
                        üìÖ <span id="filterStatusText">Todo el tiempo</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="refreshData" class="k-btn k-btn-secondary">üîÑ Actualizar</button>
                    <button id="logoutBtn" class="k-btn k-btn-secondary">üö™ Salir</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="dashboard-main">
            <!-- KPIs Section -->
            <section class="kpis-section">
                <h2 class="section-title">üìä M√©tricas Principales</h2>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">üí∞</span>
                            <span class="metric-title">Ingresos Totales</span>
                        </div>
                        <div class="metric-value" id="totalRevenue">$0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">üì¶</span>
                            <span class="metric-title">Total √ìrdenes</span>
                        </div>
                        <div class="metric-value" id="totalOrders">0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">üë•</span>
                            <span class="metric-title">Clientes √önicos</span>
                        </div>
                        <div class="metric-value" id="uniqueCustomers">0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">üìä</span>
                            <span class="metric-title">Valor Promedio</span>
                        </div>
                        <div class="metric-value" id="avgOrderValue">$0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">‚öñÔ∏è</span>
                            <span class="metric-title">Total Kilos</span>
                        </div>
                        <div class="metric-value" id="totalKilos">0 kg</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">üõçÔ∏è</span>
                            <span class="metric-title">Total Bolsas</span>
                        </div>
                        <div class="metric-value" id="totalBags">0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">üíµ</span>
                            <span class="metric-title">Precio/kg</span>
                        </div>
                        <div class="metric-value" id="avgPricePerKilo">$0</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <span class="metric-icon">‚è±Ô∏è</span>
                            <span class="metric-title">Fulfillment</span>
                        </div>
                        <div class="metric-value" id="avgFulfillmentDays">0 d√≠as</div>
                    </div>
                </div>
            </section>

            <!-- Filters -->
            <section class="filters-section">
                <h2 class="section-title">üéõÔ∏è Filtros de Per√≠odo</h2>
                <div class="period-filters">
                    <button class="period-btn active" data-period="all">Todo el tiempo</button>
                    <button class="period-btn" data-period="12m">√öltimos 12 meses</button>
                    <button class="period-btn" data-period="6m">√öltimos 6 meses</button>
                    <button class="period-btn" data-period="3m">√öltimos 3 meses</button>
                    <button class="period-btn" data-period="1m">√öltimo mes</button>
                    <button class="period-btn" id="monthlyReportBtn">Informe mensual</button>
                </div>
            </section>

            <!-- Charts Section -->
            <section class="charts-section">
                <h2 class="section-title">üìà An√°lisis de Ventas</h2>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3 class="chart-title">üìà Tendencia de Ventas</h3>
                        <div class="chart-container">
                            <canvas id="salesTrendChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">üêà Kilos Vendidos</h3>
                        <div class="chart-container">
                            <canvas id="kilosChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">üõçÔ∏è Bolsas Vendidas</h3>
                        <div class="chart-container">
                            <canvas id="bagsChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">üèÜ Top Productos</h3>
                        <div class="chart-container">
                            <canvas id="topProductsChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Additional Charts -->
            <section class="charts-section">
                <h2 class="section-title">üë• An√°lisis de Clientes</h2>
                <div class="charts-grid">
                    <div class="chart-card">
                        <h3 class="chart-title">üë• Segmentaci√≥n</h3>
                        <div class="chart-container">
                            <canvas id="customerSegmentChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">üí≥ M√©todos de Pago</h3>
                        <div class="chart-container">
                            <canvas id="paymentMethodsChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">üåé Ventas por Estado</h3>
                        <div class="chart-container">
                            <canvas id="geographicChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <h3 class="chart-title">üì¶ Fulfillment</h3>
                        <div class="chart-container">
                            <canvas id="fulfillmentChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tables Section -->
            <section class="tables-section">
                <h2 class="section-title">üìã An√°lisis Detallado</h2>

                <!-- Top Customers Table -->
                <div class="table-container">
                    <div class="table-header">
                        <h3 class="table-title">üëë Top Clientes <span class="scroll-hint">‚ÜïÔ∏è Scroll para ver m√°s</span>
                        </h3>
                        <button id="showCustomerTotalBtn" class="k-btn k-btn-secondary">üìä Ver Total</button>
                    </div>
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Email</th>
                                    <th>√ìrdenes</th>
                                    <th>Total Gastado</th>
                                    <th>Valor Promedio</th>
                                    <th>Segmento</th>
                                    <th>√öltima Compra</th>
                                </tr>
                            </thead>
                            <tbody id="topCustomersBody">
                                <!-- Data loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                    <div id="customerTotalSummary" class="table-summary hidden">
                        <div class="summary-grid">
                            <div class="summary-item">
                                <span class="summary-label">Total Clientes:</span>
                                <span class="summary-value" id="totalCustomersCount">0</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Total √ìrdenes:</span>
                                <span class="summary-value" id="totalCustomersOrders">0</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Total Gastado:</span>
                                <span class="summary-value" id="totalCustomersSpent">$0</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Promedio por Cliente:</span>
                                <span class="summary-value" id="avgCustomerSpent">$0</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Monthly Summary Table -->
                <div class="table-container">
                    <div class="table-header">
                        <h3 class="table-title">üìà Resumen Mensual</h3>
                    </div>
                    <div class="table-wrapper">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Mes</th>
                                    <th>√ìrdenes</th>
                                    <th>Ingresos</th>
                                    <th>Clientes</th>
                                    <th>Valor Promedio</th>
                                    <th>Kilos</th>
                                </tr>
                            </thead>
                            <tbody id="monthlyAnalysisBody">
                                <!-- Data loaded dynamically -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="shopify-analytics-script.js"></script>
</body>

</html>
@tailwind base;
@tailwind components;
@tailwind utilities;

/* Variables CSS para modo oscuro/claro con paleta K-mita mejorada */
:root {
  --bg-primary: #ffffff;
  --bg-secondary: #f8fafc;
  --bg-tertiary: #f1f5f9;
  --text-primary: #1e293b;
  --text-secondary: #64748b;
  --text-tertiary: #94a3b8;
  --border-color: #e2e8f0;
  --shadow-color: rgba(0, 0, 0, 0.1);
  --k-mita-50: #FC4569;
  --k-mita-100: #FFFFFF;
  --k-mita-200: #8A6A56;
  --k-mita-300: #756558;
  --k-mita-400: #635549;
  --k-mita-500: #49362B;
  --k-mita-600: #362418;
  --k-mita-700: #110E0B;
}

.dark {
  --bg-primary: #110E0B;
  --bg-secondary: #362418;
  --bg-tertiary: #49362B;
  --text-primary: #FFFFFF;
  --text-secondary: #756558;
  --text-tertiary: #8A6A56;
  --border-color: #362418;
  --shadow-color: rgba(17, 14, 11, 0.8);
}

/* Aplicar variables CSS a elementos base con gradientes K-mita */
@layer base {
  body {
    @apply bg-gradient-to-br from-[var(--bg-primary)] via-white to-[var(--k-mita-100)] dark:from-[var(--k-mita-700)] dark:via-[var(--k-mita-600)] dark:to-[var(--k-mita-700)] text-[var(--text-primary)];
    transition: background-color 0.3s ease;
  }

  .dark body {
    @apply bg-gradient-to-br from-[var(--bg-primary)] via-[var(--k-mita-600)] to-[var(--k-mita-700)] text-[var(--text-primary)];
  }
}

/* Componentes enriquecidos con estilo Apple + elementos del CSS original */
@layer components {
  /* Card con gradientes sutiles, sombras elevadas y hovers avanzados */
  .k-card {
    @apply relative bg-[var(--bg-primary)] dark:bg-[var(--bg-primary)] rounded-2xl shadow-apple border border-[var(--border-color)] dark:border-[var(--border-color)] p-6 transition-all duration-300 ease-out overflow-hidden;
    background-image: linear-gradient(135deg, rgba(252, 69, 105, 0.02) 0%, transparent 100%);
  }

  .dark .k-card {
    background-image: linear-gradient(135deg, rgba(252, 69, 105, 0.05) 0%, transparent 100%);
  }

  .k-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(to bottom right, transparent, rgba(252, 69, 105, 0.05));
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .k-card:hover::before {
    opacity: 1;
  }

  .k-card:hover {
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);
    transform: translateY(-0.5rem);
    ring-width: 1px;
    ring-color: rgba(252, 69, 105, 0.2);
  }

  /* Botones con brillos, gradientes y efectos Apple */
  .k-button {
    @apply relative px-6 py-3 rounded-xl font-semibold transition-all duration-200 focus:outline-none focus:ring-offset-2;
    position: relative;
    box-sizing: border-box;
  }

  .k-button:focus {
    outline: none;
    ring-width: 4px;
    ring-color: rgba(252, 69, 105, 0.2);
    ring-offset: 2px;
  }

  .k-button-primary {
    @apply k-button bg-gradient-to-r from-[var(--k-mita-50)] to-[var(--k-mita-200)] text-white shadow-lg hover:shadow-apple-lg active:shadow-apple;
    position: relative;
    overflow: hidden;
  }

  .k-button-primary::before {
    content: '';
    position: absolute;
    inset: 0;
    background-color: rgba(255, 255, 255, 0.2);
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  .k-button-primary:hover::before {
    @apply opacity-100;
  }

  .k-button-primary:active {
    @apply transform scale-95;
  }

  .k-button-secondary {
    @apply k-button bg-[var(--bg-primary)] dark:bg-[var(--bg-secondary)] text-[var(--text-primary)] dark:text-[var(--text-primary)] border-2 border-[var(--border-color)] dark:border-[var(--border-color)] hover:bg-[var(--bg-secondary)] dark:hover:bg-[var(--bg-tertiary)] hover:border-[var(--k-mita-50)] dark:hover:border-[var(--k-mita-50)];
  }

  /* Inputs con foco animado y placeholders estilizados */
  .k-input {
    @apply px-4 py-3 border-2 border-[var(--border-color)] dark:border-[var(--border-color)] rounded-xl bg-[var(--bg-primary)] dark:bg-[var(--bg-secondary)] text-[var(--text-primary)] dark:text-[var(--text-primary)] placeholder-[var(--text-tertiary)] dark:placeholder-[var(--text-tertiary)] transition-all duration-200;
    outline: none;
  }

  .k-input:focus {
    outline: none;
    ring-width: 4px;
    ring-color: rgba(252, 69, 105, 0.2);
    border-color: var(--k-mita-50);
  }

  /* Sidebar/Barra de navegación con backdrop-blur y slide avanzado */
  .k-nav-bar {
    @apply fixed top-16 left-0 w-64 h-auto backdrop-blur-xl border-b border-[var(--border-color)] dark:border-[var(--border-color)] transform -translate-y-full transition-all duration-500 ease-out z-50 shadow-2xl rounded-b-2xl;
    background-color: rgba(255, 255, 255, 0.95);
  }

  .dark .k-nav-bar {
    background-color: rgba(17, 14, 11, 0.95);
  }

  .k-nav-bar.open {
    @apply translate-y-0 shadow-apple-xl;
  }

  .k-nav-item {
    @apply flex items-center w-full px-6 py-4 text-base font-semibold rounded-xl transition-all duration-300 hover:text-[var(--k-mita-50)] active:scale-95;
  }

  .k-nav-item:hover {
    background-color: rgba(252, 69, 105, 0.1);
  }

  .dark .k-nav-item:hover {
    background-color: rgba(252, 69, 105, 0.2);
  }

  .k-nav-item.active {
    @apply bg-gradient-to-r from-[var(--k-mita-50)] to-[var(--k-mita-200)] text-white shadow-apple;
  }

  /* Overlay con blur */
  .k-overlay {
    @apply fixed inset-0 z-40 opacity-0 invisible transition-all duration-300;
    background-color: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
  }

  .k-overlay.open {
    @apply opacity-100 visible;
  }

  /* Login box con gradiente y sombra profunda (del CSS original) */
  .login-container {
    @apply min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-[var(--k-mita-200)] via-[var(--k-mita-100)] to-[var(--k-mita-300)] dark:from-[var(--k-mita-600)] dark:via-[var(--k-mita-500)] dark:to-[var(--k-mita-700)];
  }

  .login-box {
    @apply relative backdrop-blur-xl rounded-3xl shadow-apple-xl p-8 w-full max-w-md animate-slide-up border border-[var(--border-color)] dark:border-[var(--border-color)];
    background-color: rgba(255, 255, 255, 0.95);
  }

  .dark .login-box {
    background-color: rgba(17, 14, 11, 0.95);
  }

  .login-header h1 {
    @apply text-3xl font-bold text-[var(--k-mita-700)] dark:text-[var(--k-mita-100)] mb-4 text-center;
  }

  .login-btn {
    @apply w-full bg-gradient-to-r from-[var(--k-mita-50)] to-[var(--k-mita-200)] text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-apple-xl active:scale-95 transition-all duration-200;
  }

  .login-error {
    @apply border text-red-700 dark:text-red-300 p-3 rounded-xl text-sm text-center;
    background-color: rgba(254, 242, 242, 0.8);
    border-color: rgba(254, 202, 202, 0.5);
  }

  .dark .login-error {
    background-color: rgba(127, 29, 29, 0.2);
    border-color: rgba(153, 27, 27, 0.5);
  }

  /* KPIs con iconos grandes, gradientes y animaciones (enriquecido del original) */
  .kpi-card {
    @apply relative k-card flex items-center space-x-4 overflow-hidden;
    background-image: linear-gradient(135deg, rgba(252, 69, 105, 0.05) 0%, transparent 100%);
  }

  .kpi-card::after {
    content: '';
    position: absolute;
    right: 0;
    top: 0;
    width: 8rem;
    height: 100%;
    background: linear-gradient(to bottom, transparent, rgba(252, 69, 105, 0.1));
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .kpi-card:hover::after {
    opacity: 1;
  }

  .kpi-icon {
    @apply text-4xl opacity-80 animate-bounce-subtle;
  }

  .kpi-content h3 {
    @apply text-xs font-bold uppercase tracking-wider text-[var(--text-secondary)] dark:text-[var(--text-tertiary)] mb-1;
  }

  .kpi-content .value {
    @apply text-3xl font-black text-[var(--text-primary)] dark:text-[var(--text-primary)];
  }

  .kpi-content .change {
    @apply text-xs font-medium mt-1;
  }

  /* Filtros con diseño más elaborado */
  .filters-card {
    @apply k-card p-6;
  }

  .filter-group {
    @apply flex-1;
  }

  .filter-group label {
    @apply block text-sm font-bold text-[var(--text-primary)] dark:text-[var(--text-primary)] mb-2 uppercase tracking-wide;
  }

  .filter-buttons {
    @apply flex flex-wrap gap-3;
  }

  .filter-btn {
    @apply px-4 py-2 rounded-full text-sm font-medium border-2 border-[var(--border-color)] dark:border-[var(--border-color)] bg-[var(--bg-primary)] dark:bg-[var(--bg-secondary)] text-[var(--text-secondary)] dark:text-[var(--text-tertiary)] hover:border-[var(--k-mita-50)] hover:text-[var(--k-mita-50)] transition-all duration-200;
  }

  .filter-btn.active {
    @apply bg-[var(--k-mita-50)] text-white border-[var(--k-mita-50)] shadow-apple;
  }

  /* Charts containers con bordes y sombras */
  .chart-container {
    @apply k-card p-6;
  }

  .chart-container h3 {
    @apply text-xl font-bold text-[var(--text-primary)] dark:text-[var(--text-primary)] mb-6 flex items-center;
  }

  /* Tables con sticky headers y hover rows (del original) */
  .table-section {
    @apply k-card overflow-hidden;
  }

  .table-wrapper {
    @apply relative max-h-96 overflow-auto rounded-xl border border-[var(--border-color)] dark:border-[var(--border-color)];
  }

  .table-wrapper table {
    @apply w-full;
  }

  .table-wrapper thead {
    @apply sticky top-0 bg-[var(--bg-secondary)] dark:bg-[var(--bg-tertiary)] z-10;
  }

  .table-wrapper th {
    @apply px-4 py-3 text-left text-xs font-bold uppercase tracking-wider text-[var(--text-secondary)] dark:text-[var(--text-tertiary)] border-b border-[var(--border-color)] dark:border-[var(--border-color)];
  }

  .table-wrapper td {
    @apply px-4 py-3 text-sm text-[var(--text-primary)] dark:text-[var(--text-primary)] border-b;
    border-bottom-color: rgba(226, 232, 240, 0.5);
  }
  
  .dark .table-wrapper td {
    border-bottom-color: rgba(54, 36, 24, 0.5);
  }

  .table-wrapper tr:hover {
    background-color: rgba(252, 69, 105, 0.05);
  }
  
  .dark .table-wrapper tr:hover {
    background-color: rgba(252, 69, 105, 0.1);
  }

  /* Insights cards con colores semánticos y animaciones */
  .insights-grid {
    @apply grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6;
  }

  .insight-card {
    @apply k-card p-6 border-l-4;
    transition: all 0.3s ease;
  }

  .insight-card.positive {
    @apply border-green-500;
    background-color: rgba(240, 253, 244, 0.5);
  }
  
  .dark .insight-card.positive {
    background-color: rgba(6, 78, 59, 0.2);
  }

  .insight-card.warning {
    @apply border-yellow-500;
    background-color: rgba(254, 252, 232, 0.5);
  }
  
  .dark .insight-card.warning {
    background-color: rgba(146, 64, 14, 0.2);
  }

  .insight-card.negative {
    @apply border-red-500;
    background-color: rgba(254, 242, 242, 0.5);
  }
  
  .dark .insight-card.negative {
    background-color: rgba(153, 27, 27, 0.2);
  }

  .insight-card.info {
    @apply border-blue-500;
    background-color: rgba(239, 246, 255, 0.5);
  }
  
  .dark .insight-card.info {
    background-color: rgba(30, 58, 138, 0.2);
  }

  .insight-card:hover {
    @apply -translate-x-2 shadow-apple-lg;
  }

  /* Badges con gradientes */
  .badge {
    @apply inline-flex px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide;
  }

  .badge-vip {
    @apply badge bg-gradient-to-r from-yellow-400 to-yellow-500 text-yellow-900;
  }

  .badge-loyal {
    @apply badge bg-gradient-to-r from-blue-400 to-blue-500 text-blue-900;
  }

  /* Alertas con iconos y colores */
  .alert-card {
    @apply k-card p-4 border-l-4 rounded-r-xl;
  }

  .alert-card.critical {
    @apply border-red-500;
    background-color: rgba(254, 242, 242, 0.8);
  }

  .dark .alert-card.critical {
    background-color: rgba(127, 29, 29, 0.3);
  }

  .alert-card.warning {
    @apply border-yellow-500;
    background-color: rgba(254, 252, 232, 0.8);
  }

  .dark .alert-card.warning {
    background-color: rgba(146, 64, 14, 0.3);
  }

  .alert-card.info {
    @apply border-blue-500;
    background-color: rgba(239, 246, 255, 0.8);
  }

  .dark .alert-card.info {
    background-color: rgba(30, 58, 138, 0.3);
  }
}

/* Utilities personalizadas para gradientes y efectos Apple */
@layer utilities {
  .backdrop-blur-xl {
    backdrop-filter: blur(20px);
  }

  .shadow-apple {
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.12), 0 1px 2px rgba(0, 0, 0, 0.24);
  }

  .shadow-apple-lg {
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);
  }

  .shadow-apple-xl {
    box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.22);
  }

  .animate-slide-up {
    animation: slideUp 0.6s ease-out;
  }

  .animate-fade-in-up {
    animation: fadeInUp 0.6s ease-out;
  }

  .group-hover\:opacity-100:hover ~ * {
    opacity: 1;
  }
}

/* Keyframes adicionales para animaciones fluidas */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideUp {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* Estilos específicos para navegación (adaptados del original) */
#navBar {
  @apply k-nav-bar;
}

#navBar .flex.items-center.space-x-8.pb-4 {
  @apply flex-col items-start space-y-2 p-4;
}

#navBar .nav-item {
  @apply k-nav-item;
}

/* Modo oscuro para navegación */
.dark #navBar {
  background-color: rgba(17, 14, 11, 0.95);
}

.dark #navBar .nav-item {
  @apply text-[var(--text-primary)];
}

.dark #navBar .nav-item:hover {
  background-color: rgba(252, 69, 105, 0.2);
}

/* Scrollbar personalizada (del original) */
.table-wrapper::-webkit-scrollbar {
  @apply w-2 h-2;
}

.table-wrapper::-webkit-scrollbar-track {
  @apply bg-[var(--bg-tertiary)] rounded-full;
}

.table-wrapper::-webkit-scrollbar-thumb {
  @apply bg-[var(--text-secondary)] rounded-full hover:bg-[var(--text-primary)];
}

/* Responsive utilities - using native Tailwind variants */
@layer utilities {
  .grid-kpi {
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  }

  @media (min-width: 768px) {
    .grid-kpi-md {
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    }
  }
}